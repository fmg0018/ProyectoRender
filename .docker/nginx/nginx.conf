server {
    listen 80;
    server_name _;
    root /var/www/html/public;

    # Habilita Gzip para compresi贸n
    gzip on;
    gzip_types text/plain application/xml text/css application/javascript application/json;

    index index.php index.html;
    
    # Manejo de la ra铆z y rutas de Laravel (index.php)
    location / {
        try_files $uri $uri/ /index.php?$query_string;
    }

    #  CORRECCIN CLAVE: Servir archivos est谩ticos de Vite
    # Esta directiva asegura que el CSS, JS y otros assets generados 
    # en la carpeta 'build' se sirvan directamente sin pasar por PHP-FPM.
    location ~ ^/build/.+\.(css|js|map|png|jpg|jpeg|gif|svg|ico|eot|ttf|woff|woff2)$ {
        root /var/www/html/public;
        
        # Opcional: Desactiva logs y establece cache de larga duraci贸n para assets
        expires 1y;
        access_log off;
        try_files $uri =404;
    }
    
    # Configuraci贸n para pasar peticiones PHP a PHP-FPM
    location ~ \.php$ {
        # La correcci贸n de usar '127.0.0.1:9000' en lugar del socket UNIX 
        # (ya implementada en tu configuraci贸n)
        fastcgi_pass 127.0.0.1:9000; 
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        include fastcgi_params;
    }

    # Evita que Nginx sirva archivos .env, .git, etc.
    location ~ /\. {
        deny all;
    }
}